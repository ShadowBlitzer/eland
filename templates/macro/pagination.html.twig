{%- macro pagination(route, all_params, pagination) -%}
	{%- import _self as pag -%}
	{{- pag.pagination_pages(route, all_params, pagination) -}}
	{{- pag.pagination_limit_select(route, all_params, pagination) -}}
	</div>
	</div>
	</div>
{%- endmacro pagination -%}

{%- macro pagination_inline(route, all_params, pagination) -%}
	{%- import _self as pag -%}
	{{- pag.pagination_pages(route, all_params, pagination) -}}
	</div>
	</div>
	</div>
{%- endmacro pagination_inline -%}

{%- macro pagination_limit_select(route, all_params, pagination) -%}

	{%- set params = {'schema': all_params.schema, 'access': all_params.access} -%}
	{%- if all_params.view is defined -%}
		{%- set params = params|merge({'view': all_params.view}) -%}
	{%- endif -%}
	<div>
		<form>
			<span>{{- 'pagination.items_per_page'|trans }} </span>
			<select name="p[limit]" onchange="this.form.submit();">
				{%- for o in pagination.limit_options -%}
					<option value="{{- o -}}"{%- if o == pagination.limit %} selected="selected"{%- endif -%}>
						{{- o -}}
					</option>
				{%- endfor -%}
			</select>

			{%- for i1, ary in all_params -%}
				{%- if ary is iterable and i1 != 'p' -%}
					{%- for i2, value in ary -%}
						<input name="{{- i1 -}}[{{- i2 -}}]" value="{{- value -}}" type="hidden">
					{%- endfor -%}
				{%- endif -%}
			{%- endfor -%}
		</form>
	</div>
{%- endmacro pagination_limit_select -%}

{%- macro pagination_pages(route, all_params, pagination) -%}
	{%- import _self as pag -%}

	<div class="row">
	<div class="nav">
	<ul class="pagination">

	{%- if pagination.min > 1 -%}
		{{- pag.link('1', path(route, all_params|merge(
				{'p': {'start': null, 'limit': pagination.limit}}))) -}}
	{%- endif -%}

	{%- for pa in pagination.min..pagination.max -%}
		{{- pag.link(pa, path(route, all_params|merge(
				{'p':{'start': ((pa - 1) * pagination.limit)|replace_when_zero,
				'limit': pagination.limit}})),
				pa == pagination.page)
		-}}
	{%- endfor -%}

	{%- if pagination.max < pagination.page_count -%}
		{{- pag.link(pagination.page_count,
			path(route, all_params|merge(
				{'p': {'start': (pagination.page_count - 1) * pagination.limit,
				'limit': pagination.limit}})))
		-}}
	{%- endif -%}

	</ul>
	</div>

	<div class="pull-right hidden-xs">

	<div>
		<span>
			{{- 'pagination.count_items_and_pages'|trans({
				'%total%': pagination.row_count,
				'%page%': pagination.page,
				'%pages_total%': pagination.page_count
			}) -}}
		</span>
	</div>
{%- endmacro pagination_pages -%}

{%- macro link(label, link, active) -%}
	<li class="page-item{%- if active|default(false) %} active{%- endif -%}">
		<a class="page-link" href="{{- link -}}">{{- label -}}</a>
	</li>
{%- endmacro link -%}
