{% macro start() -%}
    <div class="panel panel-primary printview">
    <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered footable csv" data-sort="false">
{%- endmacro start %}

{% macro head(cols, route, all_params, sort) -%}
    <thead>
    <tr>
    {%- for column, data in cols -%}
        <th{%- if data.hide is defined %} data-hide="{{- data.hide -}}"{%- endif -%}>
        {%- if sort.columns[column] is defined -%}
            {%- set order = sort.col == column ? (sort.order == 'asc' ? 'desc' : 'asc') : sort.columns[column] -%} 
            <a href="{{- path(route, all_params|merge({'s':{'col': column, 'order': order}, 'p':{'start': null, 'limit': all_params.p.limit ?? null}})) -}}">
        {%- endif -%}
        {{- data['lbl']|trans({'%var%': data.lbl_var|default('')}) -}}
        {%- if sort.columns[column] is defined %} <i class="fa fa-sort{%- if column == sort.col -%}-{{- sort.order -}}{%- endif -%}">
        </a>    
        {%- endif -%}
        </th>
    {%- endfor -%}    
    </tr>
    </thead>
{%- endmacro head %}   

{%- macro body(rows, cols, acc_sch) -%}
    {%- import 'macro/badge.html.twig' as ba -%}
    <tbody>
    {%- for row in rows -%}
    <tr{%- if row.class is defined %} class="{{- row.class -}}"{%- endif -%}>
    {%- for c, cd in cols -%}
    <td>
    {%- if cd.route is defined -%}
    <a href="{{ path(cd.route, {(cd.route_key): row[cd.route_col_id]}|merge(acc_sch)) }}">
    {{- row[c] ?? '' -}}
    </a>
    {%- elseif cd.render is defined -%}
        {%- if cd.render == 'date' -%}
        {{- (row[c])|web_date(cd.date_precision ?? 'min') -}}
        {%- elseif cd.render == 'user' -%}
        {{- (row[c])|web_user|raw -}}
        {%- elseif cd.render == 'badge' -%}
        {{- ba.badge(row[c]) -}}
        {%- elseif cd.render == 'yes_no' -%}
        {%- if row[c] -%}{{- 'bool.yes'|trans -}}{%- else -%}{{- 'bool.no'|trans -}}{%- endif -%}
        {%- endif -%}
    {%- else -%}
    {{- row[c] ?? '' -}}
    {%- endif -%}
    </td>
    {%- endfor -%}
    </tr>
    {%- endfor -%}
    </tbody>
{%- endmacro body %}

{%- macro end() -%}  
    </table>
    </div>
    </div>
{%- endmacro end -%}
